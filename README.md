# uniapp 混合项目

实时通话，需要实现两个核心功能：

实时发送音频，流式上传
接收到语音后，自动播放。

网页版可以直接访问使用
目前测试环境链接： https://chat-test.ursai.xyz/chat.html

## uniapp + hybrid 方案， 使用了 Recorder 库 + howler 库

项目中用到了一些外部的 js，实现了以下功能：

✅ 实时录音，流数据上传；  

✅ 在移动端实现自动播放音频。

- 使用 Recorder 库 ： 做到了音频实时录制以及流文件分批上传 ，❌ 但是返回的音频数据无法自动播放。（仅在 pc 端的浏览器可以自动播放；移动端里 Android 版的微信内，时而能播放，时而不能。ios 内所有都不能自动播放音频。 ）

- howler 库：实现了移动端跨平台的音频自动播放

------- tips -------

- 不可行方案说明 1：采用 uniapp 内置 API uni.getRecorderManager()

先说结论：不可行。本以为就算不支持暂停和继续录音的功能，也可以通过定时器不断的停止录音，再开启录音解决。但没有想到的是，每次停止后再开始录音这中间存在着长时间的延迟，所以实时通信根本不可能。

- 不可行方案说明 2：uniapp + hybrid 方案， 使用 uniapp 相关的 HTML5+ API

先说结论：实时录音功能算是完成，但获取到的数据无法直接使用。 ❌

HTML5+ 的 plus.audio.getRecorder() ，确实是提供了录音功能，虽然也没有暂停和继续录音的功能，但可以利用定时器进行停止录音再开启录音，中间的延迟很小，几乎可以忽略不计，没有明显的丢帧效果，所以实时音频算是实现了，但它的问题是，拿到的数据需要你进行二次解析，才能够使用。

## 如何让代码运行【方法一： APP 模拟器】

1.  需要开发调试工具 - HbuilderX
2.  下载 XCode,使用 ios 模拟器
3.  HbuilderX 中选择 IOS 模拟器版本，开始运行。

## 如何让代码运行 【方法二： 网页版运行】

1. 需要开发工具 - vscode (visual studio code 的简称)
2. 工具内安装插件 - live server
3. 直接选择目录 hybrid->html->chat（实时语音项目的核心代码）
4. 选择 go live， 本地开发预览
